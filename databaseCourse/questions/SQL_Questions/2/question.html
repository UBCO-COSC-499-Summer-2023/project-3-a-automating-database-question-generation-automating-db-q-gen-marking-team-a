<!-- Question introduction -->
<pl-question-panel>
    Given the following relational schema, write queries in SQL to answer the English question.

    <markdown>
        customer(cid: integer, cname: string, address: string, city: string, state: string)
        product(pid: integer, pname: string, price: currency, inventory: integer)
        shipment(sid: integer, cid: integer, shipdate: DateTime)
        shippedproduct(sid: integer, pid: integer, amount: integer)
    </markdown>
</pl-question-panel>

<!-- Start Part 1 -->

<!-- Question text -->
<pl-question-panel>
    Return the customer id, name, state, and shipment date for all customers in <strong>'BC'</strong> or <strong>'IA'</strong> that have had a shipment in <strong>2022</strong>.  Order by <strong>shipdate</strong> descending.
    <br>
    Expected Output:
    <br>
    <markdown>
        +-----+--------------+-------+---------------------+
        | cid | cname        | state | shipdate            |
        +-----+--------------+-------+---------------------+
        |  11 | Aiden Adams  | BC    | 2022-09-24 00:00:00 |
        |  10 | Suzanne May  | IA    | 2022-08-26 00:00:00 |
        |   9 | Beth Rosebud | IA    | 2022-08-24 00:00:00 |
        |  12 | Betty Bains  | BC    | 2022-08-24 00:00:00 |
        |  15 | Elish Elias  | BC    | 2022-08-24 00:00:00 |
        +-----+--------------+-------+---------------------+
    </markdown>
    Note: <strong>PrairieLearn uses SQLite</strong>. To extract year from DATETIME see the following link: <a href="https://database.guide/how-to-extract-the-day-month-and-year-from-a-date-in-sqlite/">Extract Year in SQLite</a>
    Aside: When using MySQL you can use <a href="https://dev.mysql.com/doc/refman/8.0/en/date-and-time-functions.html#function_year">YEAR()</a> function to get the year form the shipment date or use date comparisons.
</pl-question-panel>


<!-- SQL editor -->
<pl-sql-element database = "./SQLElementSharedLibrary/lab3Databases/shipmentDDL.sql">
    <sql-question>
    </sql-question>
    
    <sql-answer answer = "SELECT customer.cid, cname, state, shipdate
FROM customer JOIN shipment 
    ON customer.cid = shipment.cid
WHERE strftime('%Y', shipdate) = '2022' AND (state = 'BC' OR state = 'IA')
ORDER BY shipdate DESC, cname ASC;">
    </sql-answer>

    <sql-marking>
    </sql-marking>
</pl-sql-element>

<!-- End Part 1 -->
