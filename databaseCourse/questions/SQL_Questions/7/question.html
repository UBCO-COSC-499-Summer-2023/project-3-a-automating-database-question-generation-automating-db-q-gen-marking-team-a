<!-- Question introduction -->
<pl-question-panel>
    Given the following relational schema, write queries in SQL to answer the English question.

    <markdown>
        customer(cid: integer, cname: string, address: string, city: string, state: string)
        product(pid: integer, pname: string, price: currency, inventory: integer)
        shipment(sid: integer, cid: integer, shipdate: DateTime)
        shippedproduct(sid: integer, pid: integer, amount: integer)
    </markdown>
</pl-question-panel>

<!-- Start Part 1 -->

<!-- Question text -->
<pl-question-panel>
    Return a list of products (id and name) along with the number of times it has been shipped, the total amount of all shipments, and the total value of all shipments. Only consider shipments after <strong>March 10th, 2022</strong>, and only show products if they have been shipped at least twice. Order by <strong>totalValueShipped</strong> descending.
    <br>
    Expected Output:
    <br>
    <markdown>
        +-----+-----------------+----------------------+--------------------+-------------------+
        | pid | pname           | numberOfTimesShipped | totalAmountShipped | totalValueShipped |
        +-----+-----------------+----------------------+--------------------+-------------------+
        |   9 | Sports Car      |                    2 |                  2 |         247000.00 |
        |   2 | Wooden Chair    |                    6 |                 38 |           3799.62 |
        |  10 | Textbook        |                    2 |                  5 |           1250.00 |
        |   1 | Swiss Chocolate |                    5 |                 21 |            692.79 |
        |   8 | Table           |                    3 |                 38 |            113.62 |
        |   4 | Chocolate Bar   |                    3 |                 17 |            101.15 |
        |   3 | Teddy Bear      |                    2 |                  5 |             64.95 |
        +-----+-----------------+----------------------+--------------------+-------------------+
    </markdown>
</pl-question-panel>


<!-- SQL editor -->
<pl-ddl-element>
    <ddl-question>
    </ddl-question>
    
    <ddl-answer>
    </ddl-answer>

    <ddl-marking >
    </ddl-marking>
</pl-ddl-element>

<!-- End Part 1 -->
