# pl-sql-element

The `pl-sql-element.py` file is handles everything relating to the SQL element in PrairieLearn. It renders the SQLite editor in the PrairieLearn window, it calls the functions to generate the question text, and it calls the functions to grade an SQL questions.


## SQLElementSharedLibrary

This directory contains the question's generation and grading scripts. More information can be found in the directory's respective `README.md`.  

## pl-sql-element.py

### generate(element_html, data)

The generate function is normally used to generate the correct answer for dynamic questions in PrairieLearn, however due to our approach to quesiton generation we cannot modify the necessary data keys in generate. As such, the generate function is unused, instead the question is generated within the prepare function.  


### prepare(element_html, data)

The pepare function is responsible for creating and preparing the question. It obtains the necessary parameters from the question's HTML file.  
If the question is a static question, then this function obtains the solution and the path to the question's DDL from the question's HTML file. The specified DDL file is read and then loaded into data. The question's solution is also loaded into data.  
If the question is a random question, all the necessary parameters are obtained from the question's HTML file. If a parameter is unspecified, then a default value is used. All these parameters are loaded into data then the random question is generated by calling `SQLAutogenerator.autogenerate(data)`.  
This function returns nothing. All necessary information is stored and will be referenced from data.  


### render(element_html, data)

The render function is called when the page is loaded and renders the SQL element.  
The function obtains the necessary parameters from data, reads the mustache files, and places the parameters into the mustache file. The HTML string of the mustache with inserted parameters is returned and rendered.  


### parse(element_html, data)

This function is unused for the SQL element. It would normally be used to adjust the student's submitted answer, if necessary.  


### grade(element_html, data)

The grade function grades the student's answer and places their score into data.  
This function calls `SQLCustomGrader.customGrader(data)` to grade the student's submission. It then places the returned score into the data variable. Feedback from the student's sumbission is placed into data within the custom grader.  


### test(element_html, data)

This function is unused for the SQL element. It would normally be used to run test submissions through PrairieLearn.  
Instead of the test function, this project used DroneCI and Python unittests to test the SQL element.  